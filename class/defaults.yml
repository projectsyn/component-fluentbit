parameters:
  fluentbit:
    namespace: syn-fluentbit
    config:
      service:
        port: 2020
        log_level: info
      ## https://docs.fluentbit.io/manual/pipeline/inputs
      inputs: |
        [INPUT]
            Name tail
            Path /var/log/containers/*.log
            Parser docker
            Tag kube.*
            Mem_Buf_Limit 5MB
            Skip_Long_Lines On
        [INPUT]
            Name systemd
            Tag host.*
            Systemd_Filter _SYSTEMD_UNIT=kubelet.service
            Read_From_Tail On
      extraInputs: ''
      ## https://docs.fluentbit.io/manual/pipeline/filters
      # Note: The 'Match' value needs to correspond to the tag that's set for
      # the K8s container logs in the input (cf. config.inputs).
      filters: |
        [FILTER]
            Name kubernetes
            Match kube.*
            Merge_Log On
            Keep_Log Off
            K8S-Logging.Parser On
            K8S-Logging.Exclude On
      extraFilters: ''
      ## https://docs.fluentbit.io/manual/pipeline/outputs
      outputs: ''
      ## https://docs.fluentbit.io/manual/pipeline/parsers
      customParsers: |
        [PARSER]
            Name docker_no_time
            Format json
            Time_Keep Off
            Time_Key time
            Time_Format %Y-%m-%dT%H:%M:%S.%L
            Decode_Field_As escaped log   do_next
            Decode_Field_As json    log
      extraParsers: ''
    psp_enabled: false
    monitoring:
      enabled: false
    tolerations: []
    charts:
      fluent_bit: '0.6.3'
    images:
      fluent_bit:
        image: docker.io/fluent/fluent-bit
        tag: '1.5.4'
